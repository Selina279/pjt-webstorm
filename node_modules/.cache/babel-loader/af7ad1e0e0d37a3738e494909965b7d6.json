{"remainingRequest":"/Users/selina/Documents/Vueworkspace/vuewebstrom/yourparttime/node_modules/babel-loader/lib/index.js!/Users/selina/Documents/Vueworkspace/vuewebstrom/yourparttime/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/selina/Documents/Vueworkspace/vuewebstrom/yourparttime/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/selina/Documents/Vueworkspace/vuewebstrom/yourparttime/src/components/sys/basic/PermissMana.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/selina/Documents/Vueworkspace/vuewebstrom/yourparttime/src/components/sys/basic/PermissMana.vue","mtime":1588037655548},{"path":"/Users/selina/Documents/Vueworkspace/vuewebstrom/yourparttime/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/selina/Documents/Vueworkspace/vuewebstrom/yourparttime/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/selina/Documents/Vueworkspace/vuewebstrom/yourparttime/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/selina/Documents/Vueworkspace/vuewebstrom/yourparttime/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiUGVybWlzc01hbmEiLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBhY3RpdmVOYW1lOiAtMSwKICAgICAgcm9sZTogewogICAgICAgIG5hbWU6ICcnLAogICAgICAgIG5hbWVaaDogJycKICAgICAgfSwKICAgICAgcm9sZXM6IFtdLAogICAgICBhbGxtZW51czogW10sCiAgICAgIHNlbGVjdGVkTWVudXM6IFtdLAogICAgICBkZWZhdWx0UHJvcHM6IHsKICAgICAgICBjaGlsZHJlbjogJ2NoaWxkcmVuJywKICAgICAgICBsYWJlbDogJ25hbWUnCiAgICAgIH0KICAgIH07CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdGhpcy5pbml0Um9sZXMoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGRlbGV0ZVJvbGU6IGZ1bmN0aW9uIGRlbGV0ZVJvbGUocm9sZSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdGhpcy4kY29uZmlybSgn5q2k5pON5L2c5bCG5rC45LmF5Yig6Zmk44CQJyArIHJvbGUubmFtZVpoICsgJ+OAkeinkuiJsiwg5piv5ZCm57un57utPycsICfmj5DnpLonLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpcy5kZWxldGVSZXF1ZXN0KCIvc3lzdGVtL2Jhc2ljL3Blcm1pc3Mvcm9sZS8iICsgcm9sZS5pZCkudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgICAgaWYgKHJlc3ApIHsKICAgICAgICAgICAgX3RoaXMuaW5pdFJvbGVzKCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICB0eXBlOiAnaW5mbycsCiAgICAgICAgICBtZXNzYWdlOiAn5bey5Y+W5raI5Yig6ZmkJwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBkb0FkZFJvbGU6IGZ1bmN0aW9uIGRvQWRkUm9sZSgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBpZiAodGhpcy5yb2xlLm5hbWUgJiYgdGhpcy5yb2xlLm5hbWVaaCkgewogICAgICAgIHRoaXMucG9zdFJlcXVlc3QoIi9zeXN0ZW0vYmFzaWMvcGVybWlzcy9yb2xlIiwgdGhpcy5yb2xlKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgICBpZiAocmVzcCkgewogICAgICAgICAgICBfdGhpczIucm9sZS5uYW1lID0gJyc7CiAgICAgICAgICAgIF90aGlzMi5yb2xlLm5hbWVaaCA9ICcnOwoKICAgICAgICAgICAgX3RoaXMyLmluaXRSb2xlcygpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+aVsOaNruS4jeiDveS4uuepuicpOwogICAgICB9CiAgICB9LAogICAgY2FuY2VsVXBkYXRlOiBmdW5jdGlvbiBjYW5jZWxVcGRhdGUoKSB7CiAgICAgIHRoaXMuYWN0aXZlTmFtZSA9IC0xOwogICAgfSwKICAgIGRvVXBkYXRlOiBmdW5jdGlvbiBkb1VwZGF0ZSh1aWQsIGluZGV4KSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgLy8gY29uc29sZS5sb2codWlkKTsKICAgICAgdmFyIHRyZWUgPSB0aGlzLiRyZWZzLnRyZWVbaW5kZXhdOwogICAgICB2YXIgc2VsZWN0ZWRLZXlzID0gdHJlZS5nZXRDaGVja2VkS2V5cyh0cnVlKTsKICAgICAgdmFyIHVybCA9ICcvc3lzdGVtL2Jhc2ljL3Blcm1pc3MvP3VpZD0nICsgdWlkOwogICAgICBzZWxlY3RlZEtleXMuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgdXJsICs9ICcmbWlkcz0nICsga2V5OwogICAgICB9KTsKICAgICAgdGhpcy5wdXRSZXF1ZXN0KHVybCkudGhlbihmdW5jdGlvbiAocmVzcCkgewogICAgICAgIGlmIChyZXNwKSB7CiAgICAgICAgICBfdGhpczMuYWN0aXZlTmFtZSA9IC0xOwogICAgICAgIH0KICAgICAgfSk7IC8vIGNvbnNvbGUubG9nKHNlbGVjdGVkS2V5cyk7CiAgICB9LAogICAgY2hhbmdlOiBmdW5jdGlvbiBjaGFuZ2UodWlkKSB7CiAgICAgIGlmICh1aWQpIHsKICAgICAgICB0aGlzLmluaXRBbGxNZW51cygpOwogICAgICAgIHRoaXMuaW5pdFNlbGVjdGVkTWVudXModWlkKTsKICAgICAgfQogICAgfSwKICAgIGluaXRTZWxlY3RlZE1lbnVzOiBmdW5jdGlvbiBpbml0U2VsZWN0ZWRNZW51cyh1aWQpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB0aGlzLmdldFJlcXVlc3QoIi9zeXN0ZW0vYmFzaWMvcGVybWlzcy9taWRzLyIgKyB1aWQpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICBjb25zb2xlLmxvZygnISEhJyArIHJlc3ApOwoKICAgICAgICBpZiAocmVzcCkgewogICAgICAgICAgX3RoaXM0LnNlbGVjdGVkTWVudXMgPSByZXNwOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgaW5pdEFsbE1lbnVzOiBmdW5jdGlvbiBpbml0QWxsTWVudXMoKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgdGhpcy5nZXRSZXF1ZXN0KCIvc3lzdGVtL2Jhc2ljL3Blcm1pc3MvbWVudXMiKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgaWYgKHJlc3ApIHsKICAgICAgICAgIF90aGlzNS5hbGxtZW51cyA9IHJlc3A7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBpbml0Um9sZXM6IGZ1bmN0aW9uIGluaXRSb2xlcygpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICB0aGlzLmdldFJlcXVlc3QoIi9zeXN0ZW0vYmFzaWMvcGVybWlzcy8iKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgaWYgKHJlc3ApIHsKICAgICAgICAgIF90aGlzNi5yb2xlcyA9IHJlc3A7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["PermissMana.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div>\n        <div class=\"permissManaTool1\">\n            <el-input size=\"small\" placeholder=\"请输入角色英文名\" v-model=\"role.name\">\n                <tempate slot=\"prepend\">ROLE_</tempate>\n            </el-input>\n            <el-input size=\"small\" placeholder=\"请输入角色中文名\" v-model=\"role.nameZh\" @keydown.enter.native=\"doAddRole\"></el-input>\n             <el-button  type=\"primary\" size=\"small\" icon=\"el-icon-plus\" @click=\"doAddRole\">添加角色</el-button>\n        </div>\n        <div class=\"permissManaMain\">\n            <el-collapse v-model=\"activeName\" accordion @change=\"change\">\n              <el-collapse-item :title=\"r.nameZh\" :name=\"r.id\" v-for=\"(r,index) in roles\" :key=\"index\">\n                  <el-card class=\"box-card\">\n                      <div slot=\"header\" class=\"clearfix\">\n                          <span>可访问的资源</span>\n                          <el-button style=\"float: right; padding: 3px 0;color: #ff0000\" icon=\"el-icon-delete\" type=\"text\" @click=\"deleteRole(r)\"></el-button>\n                      </div>\n                      <div>\n                          <el-tree\n                                  show-checkbox\n                                  node-key=\"id\"\n                                  ref=\"tree\"\n                                  :default-checked-keys=\"selectedMenus\"\n                                  :data=\"allmenus\"\n                                  :props=\"defaultProps\">\n                          </el-tree>\n                          <div style=\"display: flex;justify-content: flex-end\">\n                              <el-button size=\"small\" @click=\"cancelUpdate\">取消修改</el-button>\n                              <el-button size=\"small\" type=\"primary\" @click=\"doUpdate(r.id,index)\">确认修改</el-button>\n                          </div>\n                      </div>\n                  </el-card>\n              </el-collapse-item>\n            </el-collapse>\n        </div>\n    </div>\n</template>\n\n<script>\n    export default {\n        name: \"PermissMana\",\n        data(){\n            return{\n                activeName: -1,\n                role:{\n                    name:'',\n                    nameZh:''\n                },\n                roles:[],\n                allmenus:[],\n                selectedMenus:[],\n                defaultProps: {\n                    children: 'children',\n                    label: 'name'\n                }\n            }\n        },\n        mounted() {\n            this.initRoles();\n        },\n        methods:{\n            deleteRole(role){\n                this.$confirm('此操作将永久删除【'+role.nameZh+'】角色, 是否继续?', '提示', {\n                    confirmButtonText: '确定',\n                    cancelButtonText: '取消',\n                    type: 'warning'\n                }).then(() => {\n                    this.deleteRequest(\"/system/basic/permiss/role/\"+role.id).then(resp=>{\n                        if(resp){\n                            this.initRoles();\n                        }\n                    })\n                }).catch(() => {\n                    this.$message({\n                        type: 'info',\n                        message: '已取消删除'\n                    });\n                });\n            },\n            doAddRole(){\n                if(this.role.name && this.role.nameZh){\n                    this.postRequest(\"/system/basic/permiss/role\",this.role).then(resp=>{\n                        if(resp){\n                            this.role.name='';\n                            this.role.nameZh='';\n                            this.initRoles();\n                        }\n                    })\n                }else{\n                    this.$message.error('数据不能为空');\n                }\n            },\n            cancelUpdate(){\n                this.activeName=-1;\n            },\n            doUpdate(uid,index){\n                // console.log(uid);\n                let tree = this.$refs.tree[index];\n                let selectedKeys=tree.getCheckedKeys(true);\n                let url='/system/basic/permiss/?uid='+uid;\n                selectedKeys.forEach(key=>{\n                    url+='&mids='+key;\n                })\n                this.putRequest(url).then(resp=>{\n                    if(resp){\n                        this.activeName=-1;\n                    }\n                })\n                // console.log(selectedKeys);\n            },\n            change(uid){\n                if(uid){\n                    this.initAllMenus();\n                    this.initSelectedMenus(uid);\n                }\n            },\n            initSelectedMenus(uid){\n              this.getRequest(\"/system/basic/permiss/mids/\"+uid).then(resp=>{\n                  console.log('!!!'+resp);\n                  if(resp){\n                      this.selectedMenus=resp;\n                  }\n              })\n            },\n            initAllMenus(){\n              this.getRequest(\"/system/basic/permiss/menus\").then(resp=>{\n                  if(resp){\n                      this.allmenus=resp;\n                  }\n              })\n            },\n            initRoles(){\n                this.getRequest(\"/system/basic/permiss/\").then(resp=>{\n                    if(resp){\n                        this.roles=resp;\n                    }\n                })\n            }\n        }\n    }\n</script>\n\n<style>\n    .permissManaTool1{\n        display: flex;\n        justify-content: flex-start;\n    }\n    .permissManaTool1 .el-input{\n        width: 300px;\n        margin-right: 10px;\n    }\n    .permissManaMain{\n         margin-top: 15px;\n         width: 70%;\n    }\n</style>"],"sourceRoot":"src/components/sys/basic"}]}