{"remainingRequest":"/Users/selina/Documents/Vueworkspace/vuewebstrom/yourparttime/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/selina/Documents/Vueworkspace/vuewebstrom/yourparttime/src/views/sys/SysUser.vue?vue&type=style&index=0&id=43926bac&scoped=true&lang=css&","dependencies":[{"path":"/Users/selina/Documents/Vueworkspace/vuewebstrom/yourparttime/src/views/sys/SysUser.vue","mtime":1588754773297},{"path":"/Users/selina/Documents/Vueworkspace/vuewebstrom/yourparttime/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/selina/Documents/Vueworkspace/vuewebstrom/yourparttime/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/selina/Documents/Vueworkspace/vuewebstrom/yourparttime/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/selina/Documents/Vueworkspace/vuewebstrom/yourparttime/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/selina/Documents/Vueworkspace/vuewebstrom/yourparttime/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmltZy1jb250YWluZXJ7CiAgICB3aWR0aDogMTAwJTsKICAgIGRpc3BsYXk6IGZsZXg7CiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKfQoudXNlcmZhY2UtaW1newogICAgd2lkdGg6IDUwcHg7CiAgICBoZWlnaHQ6IDUwcHg7CiAgICBib3JkZXItcmFkaXVzOiA1MHB4Owp9Ci51c2VyLWNvbnRhaW5lcnsKICAgIG1hcmdpbi10b3A6IDIwcHg7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgZmxleC13cmFwOiB3cmFwOwogICAgLypqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWFyb3VuZDsqLwp9Ci51c2VyLWNhcmR7CiAgICB3aWR0aDozNTBweDsKICAgIG1hcmdpbi1ib3R0b206IDIwcHg7CiAgICBtYXJnaW4tcmlnaHQ6IDIwcHg7Cn0KLnVzZXJpbmZvLWNvbnRhaW5lcnsKICAgIG1hcmdpbi10b3A6IDEwcHg7Cn0KLnVzZXJpbmZvLWNvbnRhaW5lciBkaXZ7CiAgICBmb250LXNpemU6IDEzcHg7CiAgICBjb2xvcjogIzAwOTlGRjsKfQo="},{"version":3,"sources":["SysUser.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SysUser.vue","sourceRoot":"src/views/sys","sourcesContent":["<template>\n    <div>\n        <div style=\"margin-top: 10px;display:flex;justify-content:center\" >\n            <el-input v-model=\"keywords\" placeholder=\"通过用户名搜索用户...\" prefix-icon=\"el-icon-search\" style=\"width:400px; margin-right: 10px\" size=\"small\"@keydown.enter.native=\"doSearch\"></el-input>\n            <el-button icon=\"el-icon-search\" type=\"primary\" size=\"small\" @click=\"doSearch\">搜索</el-button>\n        </div>\n        <div class=\"user-container\">\n            <el-card class=\"user-card\" v-for=\"(user,index) in users\" :key=\"index\">\n                <div slot=\"header\" class=\"clearfix\">\n                    <span>{{user.name}}</span>\n                    <el-button style=\"float: right; padding: 3px 0;color:#e30007\" type=\"text\" icon=\"el-icon-delete\" @click=\"deleteUser(user)\"></el-button>\n                </div>\n                <div>\n                    <div class=\"img-container\">\n                        <img :src=\"user.userface\" :alt=\"user.name\" :title=\"user.name\" class=\"userface-img\">\n                    </div>\n                    <div class=\"userinfo-container\">\n                        <div>\n                            <div>用户名：{{user.name}}</div>\n                            <div>手机号码：{{user.phone}}</div>\n                            <div>电话号码：{{user.telephone}}</div>\n                            <div>地址：{{user.address}}</div>\n                            <div>用户状态：<el-switch\n                                    v-model=\"user.enabled\"\n                                    active-color=\"#13ce66\"\n                                    inactive-color=\"#ff4949\"\n                                    active-text=\"启用\"\n                                    inactive-text=\"禁用\"\n                                    @change=\"enabledChange(user)\">\n                            </el-switch> </div>\n                            <div>用户角色：\n                                <el-tag type=\"success\" style=\"margin-right: 4px;\" size=\"small\" v-for=\"(role,indexj) in user.roles\" :key=\"indexj\">{{role.nameZh}}</el-tag>\n                                <el-popover\n                                        placement=\"right\"\n                                        title=\"角色列表\"\n                                        @show=\"showPop(user)\"\n                                        width=\"200\"\n                                        @hide=\"hidePop(user)\"\n                                        trigger=\"click\">\n                                    <el-select v-model=\"selectedRoles\" multiple placeholder=\"请选择\" size=\"small\">\n                                        <el-option\n                                                v-for=\"(r,index) in allroles\"\n                                                :key=\"indexk\"\n                                                :label=\"r.nameZh\"\n                                                :value=\"r.id\">\n                                        </el-option>\n                                    </el-select>\n                                    <el-button slot=\"reference\" icon=\"el-icon-more\" type=\"text\"/>\n                                </el-popover>\n                            </div>\n                            <div>备注：{{user.remark}}</div>\n                        </div>\n                    </div>\n                </div>\n            </el-card>\n        </div>\n    </div>\n</template>\n\n<script>\n    export default {\n        name: \"SysUser\",\n        data(){\n            return{\n                keywords:'',\n                users:[],\n                allroles:[],\n                selectedRoles:[]\n            }\n        },\n        mounted() {\n            this.initUsers();\n        },\n        methods:{\n            deleteUser(user){\n                this.$confirm('此操作将永久删除【'+user.name+'】, 是否继续?', '提示', {\n                    confirmButtonText: '确定',\n                    cancelButtonText: '取消',\n                    type: 'warning'\n                }).then(() => {\n                    this.deleteRequest(\"/system/user/\"+user.id).then(resp=>{\n                        if(resp){\n                            this.initUsers();\n                        }\n                    })\n                }).catch(() => {\n                    this.$message({\n                        type: 'info',\n                        message: '已取消删除'\n                    });\n                });\n            },\n            doSearch(){\n                this.initUsers();\n            },\n            hidePop(user){\n                let roles=[];\n                Object.assign(roles,user.roles);\n                let flag=false;\n                if(roles.length!=this.selectedRoles.length){\n                    flag=true;\n                }else{\n                    for(let i=0;i<roles.length;i++){\n                        let role=roles[i];\n                        for(let j=0;j<this.selectedRoles.length;j++){\n                            let sr=this.selectedRoles[j];\n                            if(role.id==sr){\n                                roles.splice(i,1);\n                                i--;\n                                break;\n                            }\n                        }\n                    }\n                    if(roles.length!=0){\n                        flag=true;\n                    }\n                }\n                if(flag){\n                    let url='/system/user/role?userid='+user.id;\n                    this.selectedRoles.forEach(sr=>{\n                        url+='&uids='+sr;\n                    })\n                    this.putRequest(url).then(resp=>{\n                        if(resp){\n                            this.initUsers();\n                        }\n                    })\n                }\n            },\n            showPop(user){\n                this.initAllRoles();\n                let roles=user.roles;\n                this.selectedRoles=[];\n                roles.forEach(r=>{\n                    this.selectedRoles.push(r.id);\n                })\n            },\n            initAllRoles(){\n              this.getRequest(\"/system/user/roles/\").then(resp=>{\n                  if(resp){\n                      this.allroles=resp;\n                  }\n              })\n            },\n            initUsers(){\n                this.getRequest(\"/system/user/?keywords=\"+this.keywords).then(resp=>{\n                    if(resp){\n                        this.users=resp;\n                    }\n                })\n            },\n            enabledChange(user){\n                console.log(user);\n                delete user.roles;\n                this.putRequest(\"/system/user/\",user).then(resp=>{\n                    if(resp){\n                        this.initUsers();\n                    }\n                })\n            }\n        }\n    }\n</script>\n\n<style scoped>\n    .img-container{\n        width: 100%;\n        display: flex;\n        justify-content: center;\n    }\n    .userface-img{\n        width: 50px;\n        height: 50px;\n        border-radius: 50px;\n    }\n    .user-container{\n        margin-top: 20px;\n        display: flex;\n        flex-wrap: wrap;\n        /*justify-content: space-around;*/\n    }\n    .user-card{\n        width:350px;\n        margin-bottom: 20px;\n        margin-right: 20px;\n    }\n    .userinfo-container{\n        margin-top: 10px;\n    }\n    .userinfo-container div{\n        font-size: 13px;\n        color: #0099FF;\n    }\n</style>"]}]}